{"remainingRequest":"/home/zyx/workspaces/python/server_management/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/zyx/workspaces/python/server_management/client/src/views/Instances.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/home/zyx/workspaces/python/server_management/client/src/views/Instances.vue","mtime":1621433464856},{"path":"/home/zyx/workspaces/python/server_management/client/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/zyx/workspaces/python/server_management/client/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/home/zyx/workspaces/python/server_management/client/node_modules/@vue/cli-service/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/home/zyx/workspaces/python/server_management/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/zyx/workspaces/python/server_management/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5lbC10YWJsZSAud2FybmluZy1yb3cgewogIGJhY2tncm91bmQ6IG9sZGxhY2U7Cn0KCi5lbC10YWJsZSAuc3VjY2Vzcy1yb3cgewogIGJhY2tncm91bmQ6ICNmMGY5ZWI7Cn0K"},{"version":3,"sources":["Instances.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoDA;AACA;AACA;;AAEA;AACA;AACA","file":"Instances.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <data-table\n      ref=\"dateTable\"\n      :apiUrl=\"instancesURL\"\n      :row-class-name=\"tableRowClassName\"\n      :key=\"tableKey\"\n    >\n    <template slot=\"columns\">\n      <el-table-column\n      type=\"index\"\n      width=\"50\"\n      label=\"实例\"\n      align=\"center\">\n      </el-table-column>\n      <el-table-column prop=\"name\" label=\"实例名\" align=\"center\"></el-table-column>\n      <el-table-column prop=\"left_time\" label=\"时长\" align=\"center\" \n        :formatter=\"timeFormat\">\n      </el-table-column>\n      <el-table-column prop=\"status\" label=\"状态\" align=\"center\" \n        :formatter=\"statusFormat\">\n      </el-table-column>\n      <el-table-column prop=\"gpu_num\" label=\"GPU数量\">\n        <template slot-scope=\"scope\">\n          <el-select v-model=\"scope.row.gpu_num\" placeholder=\"请选择\" :disabled=\"handleDisable(scope.$index, scope.row)\">\n            <el-option\n              v-for=\"item in options\"\n              :key=\"item.value\"\n              :label=\"item.label\"\n              :value=\"item.value\">\n            </el-option>\n          </el-select>\n          </template>\n      </el-table-column>\n      <el-table-column\n      label=\"操作\"\n      align=\"center\">\n      <template slot-scope=\"scope\">\n        <el-button\n          type=\"warning\"\n          size=\"mini\"\n          icon=\"el-icon-edit\"\n          :disabled=\"handleDisable(scope.$index, scope.row)\"\n          @click=\"handleApply(scope.$index, scope.row)\">申请</el-button>\n      </template>\n    </el-table-column>\n    </template>\n    </data-table>\n  </div>\n</template>\n\n<style>\n  .el-table .warning-row {\n    background: oldlace;\n  }\n\n  .el-table .success-row {\n    background: #f0f9eb;\n  }\n</style>\n\n<script>\nimport {api_routes, apiCall} from '@/utils/api';\nimport DataTable from '@/components/DataTable';\n\nexport default {\n  name: 'bigTable',\n  components: {\n    DataTable,\n  },\n  data() {\n    return {\n      instancesURL: api_routes.user.instances,\n      method: \"post\",\n      tableKey: 0,\n      options: [{\n        value: 0,\n        label: '仅CPU资源'\n      }, {\n        value: 1,\n        label: '1卡'\n      }, {\n        value: 2,\n        label: '2卡'\n      }, {\n        value: 4,\n        label: '4卡'\n      },],\n    };\n  },\n  mounted() {},\n  methods: {\n    gpuFormat(row, column) {\n      return row.gpu_num + \"卡\";\n    },\n    timeFormat(row, column) {\n      return row.left_time + \"天\";\n    },\n    statusFormat(row, column) {\n      if (row.status == \"free\"){\n        return \"空闲\";\n      }else if (row.status == \"wait\"){\n        return \"已被申请\";\n      }else{\n        return \"已被分配\";\n      }\n    },\n    tableRowClassName({row, rowIndex}) {\n      console.log(\"row class \", rowIndex, rowIndex % 2, rowIndex == 1);\n      if ((rowIndex % 3) == 1) {\n        return 'warning-row';\n      } else{\n        return 'success-row';\n      }\n    },\n    handleApply(row_index, row){\n      let {name, gpu_num, opt_gpu_num} = row;\n      let applyURL = api_routes.user.apply;\n      this.$confirm('这会提交一次申请，确认吗', 'Warning', {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        this.$message({\n          type: 'success',\n          message: '申请已提交'\n        });\n        apiCall({url: applyURL, data: {name, gpu_num, opt_gpu_num}, method: \"post\"})\n          .then(resp => {this.$message({type: 'info', message: resp.message}); this.tableKey += 1;});\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '申请取消'\n        });          \n      });\n    },\n    handleDisable(index, row){\n      return row.status != \"free\";\n    }\n  },\n};\n</script>\n"]}]}
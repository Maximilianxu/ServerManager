{"remainingRequest":"/home/zyx/workspaces/python/server_management/client/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/zyx/workspaces/python/server_management/client/src/views/Instances.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/zyx/workspaces/python/server_management/client/src/views/Instances.vue","mtime":1621433464856},{"path":"/home/zyx/workspaces/python/server_management/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/zyx/workspaces/python/server_management/client/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/zyx/workspaces/python/server_management/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/zyx/workspaces/python/server_management/client/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7YXBpX3JvdXRlcywgYXBpQ2FsbH0gZnJvbSAnQC91dGlscy9hcGknOwppbXBvcnQgRGF0YVRhYmxlIGZyb20gJ0AvY29tcG9uZW50cy9EYXRhVGFibGUnOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdiaWdUYWJsZScsCiAgY29tcG9uZW50czogewogICAgRGF0YVRhYmxlLAogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGluc3RhbmNlc1VSTDogYXBpX3JvdXRlcy51c2VyLmluc3RhbmNlcywKICAgICAgbWV0aG9kOiAicG9zdCIsCiAgICAgIHRhYmxlS2V5OiAwLAogICAgICBvcHRpb25zOiBbewogICAgICAgIHZhbHVlOiAwLAogICAgICAgIGxhYmVsOiAn5LuFQ1BV6LWE5rqQJwogICAgICB9LCB7CiAgICAgICAgdmFsdWU6IDEsCiAgICAgICAgbGFiZWw6ICcx5Y2hJwogICAgICB9LCB7CiAgICAgICAgdmFsdWU6IDIsCiAgICAgICAgbGFiZWw6ICcy5Y2hJwogICAgICB9LCB7CiAgICAgICAgdmFsdWU6IDQsCiAgICAgICAgbGFiZWw6ICc05Y2hJwogICAgICB9LF0sCiAgICB9OwogIH0sCiAgbW91bnRlZCgpIHt9LAogIG1ldGhvZHM6IHsKICAgIGdwdUZvcm1hdChyb3csIGNvbHVtbikgewogICAgICByZXR1cm4gcm93LmdwdV9udW0gKyAi5Y2hIjsKICAgIH0sCiAgICB0aW1lRm9ybWF0KHJvdywgY29sdW1uKSB7CiAgICAgIHJldHVybiByb3cubGVmdF90aW1lICsgIuWkqSI7CiAgICB9LAogICAgc3RhdHVzRm9ybWF0KHJvdywgY29sdW1uKSB7CiAgICAgIGlmIChyb3cuc3RhdHVzID09ICJmcmVlIil7CiAgICAgICAgcmV0dXJuICLnqbrpl7IiOwogICAgICB9ZWxzZSBpZiAocm93LnN0YXR1cyA9PSAid2FpdCIpewogICAgICAgIHJldHVybiAi5bey6KKr55Sz6K+3IjsKICAgICAgfWVsc2V7CiAgICAgICAgcmV0dXJuICLlt7LooqvliIbphY0iOwogICAgICB9CiAgICB9LAogICAgdGFibGVSb3dDbGFzc05hbWUoe3Jvdywgcm93SW5kZXh9KSB7CiAgICAgIGNvbnNvbGUubG9nKCJyb3cgY2xhc3MgIiwgcm93SW5kZXgsIHJvd0luZGV4ICUgMiwgcm93SW5kZXggPT0gMSk7CiAgICAgIGlmICgocm93SW5kZXggJSAzKSA9PSAxKSB7CiAgICAgICAgcmV0dXJuICd3YXJuaW5nLXJvdyc7CiAgICAgIH0gZWxzZXsKICAgICAgICByZXR1cm4gJ3N1Y2Nlc3Mtcm93JzsKICAgICAgfQogICAgfSwKICAgIGhhbmRsZUFwcGx5KHJvd19pbmRleCwgcm93KXsKICAgICAgbGV0IHtuYW1lLCBncHVfbnVtLCBvcHRfZ3B1X251bX0gPSByb3c7CiAgICAgIGxldCBhcHBseVVSTCA9IGFwaV9yb3V0ZXMudXNlci5hcHBseTsKICAgICAgdGhpcy4kY29uZmlybSgn6L+Z5Lya5o+Q5Lqk5LiA5qyh55Sz6K+377yM56Gu6K6k5ZCXJywgJ1dhcm5pbmcnLCB7CiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7orqQnLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLAogICAgICAgIHR5cGU6ICd3YXJuaW5nJwogICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywKICAgICAgICAgIG1lc3NhZ2U6ICfnlLPor7flt7Lmj5DkuqQnCiAgICAgICAgfSk7CiAgICAgICAgYXBpQ2FsbCh7dXJsOiBhcHBseVVSTCwgZGF0YToge25hbWUsIGdwdV9udW0sIG9wdF9ncHVfbnVtfSwgbWV0aG9kOiAicG9zdCJ9KQogICAgICAgICAgLnRoZW4ocmVzcCA9PiB7dGhpcy4kbWVzc2FnZSh7dHlwZTogJ2luZm8nLCBtZXNzYWdlOiByZXNwLm1lc3NhZ2V9KTsgdGhpcy50YWJsZUtleSArPSAxO30pOwogICAgICB9KS5jYXRjaCgoKSA9PiB7CiAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICB0eXBlOiAnaW5mbycsCiAgICAgICAgICBtZXNzYWdlOiAn55Sz6K+35Y+W5raIJwogICAgICAgIH0pOyAgICAgICAgICAKICAgICAgfSk7CiAgICB9LAogICAgaGFuZGxlRGlzYWJsZShpbmRleCwgcm93KXsKICAgICAgcmV0dXJuIHJvdy5zdGF0dXMgIT0gImZyZWUiOwogICAgfQogIH0sCn07Cg=="},{"version":3,"sources":["Instances.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8DA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Instances.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <data-table\n      ref=\"dateTable\"\n      :apiUrl=\"instancesURL\"\n      :row-class-name=\"tableRowClassName\"\n      :key=\"tableKey\"\n    >\n    <template slot=\"columns\">\n      <el-table-column\n      type=\"index\"\n      width=\"50\"\n      label=\"实例\"\n      align=\"center\">\n      </el-table-column>\n      <el-table-column prop=\"name\" label=\"实例名\" align=\"center\"></el-table-column>\n      <el-table-column prop=\"left_time\" label=\"时长\" align=\"center\" \n        :formatter=\"timeFormat\">\n      </el-table-column>\n      <el-table-column prop=\"status\" label=\"状态\" align=\"center\" \n        :formatter=\"statusFormat\">\n      </el-table-column>\n      <el-table-column prop=\"gpu_num\" label=\"GPU数量\">\n        <template slot-scope=\"scope\">\n          <el-select v-model=\"scope.row.gpu_num\" placeholder=\"请选择\" :disabled=\"handleDisable(scope.$index, scope.row)\">\n            <el-option\n              v-for=\"item in options\"\n              :key=\"item.value\"\n              :label=\"item.label\"\n              :value=\"item.value\">\n            </el-option>\n          </el-select>\n          </template>\n      </el-table-column>\n      <el-table-column\n      label=\"操作\"\n      align=\"center\">\n      <template slot-scope=\"scope\">\n        <el-button\n          type=\"warning\"\n          size=\"mini\"\n          icon=\"el-icon-edit\"\n          :disabled=\"handleDisable(scope.$index, scope.row)\"\n          @click=\"handleApply(scope.$index, scope.row)\">申请</el-button>\n      </template>\n    </el-table-column>\n    </template>\n    </data-table>\n  </div>\n</template>\n\n<style>\n  .el-table .warning-row {\n    background: oldlace;\n  }\n\n  .el-table .success-row {\n    background: #f0f9eb;\n  }\n</style>\n\n<script>\nimport {api_routes, apiCall} from '@/utils/api';\nimport DataTable from '@/components/DataTable';\n\nexport default {\n  name: 'bigTable',\n  components: {\n    DataTable,\n  },\n  data() {\n    return {\n      instancesURL: api_routes.user.instances,\n      method: \"post\",\n      tableKey: 0,\n      options: [{\n        value: 0,\n        label: '仅CPU资源'\n      }, {\n        value: 1,\n        label: '1卡'\n      }, {\n        value: 2,\n        label: '2卡'\n      }, {\n        value: 4,\n        label: '4卡'\n      },],\n    };\n  },\n  mounted() {},\n  methods: {\n    gpuFormat(row, column) {\n      return row.gpu_num + \"卡\";\n    },\n    timeFormat(row, column) {\n      return row.left_time + \"天\";\n    },\n    statusFormat(row, column) {\n      if (row.status == \"free\"){\n        return \"空闲\";\n      }else if (row.status == \"wait\"){\n        return \"已被申请\";\n      }else{\n        return \"已被分配\";\n      }\n    },\n    tableRowClassName({row, rowIndex}) {\n      console.log(\"row class \", rowIndex, rowIndex % 2, rowIndex == 1);\n      if ((rowIndex % 3) == 1) {\n        return 'warning-row';\n      } else{\n        return 'success-row';\n      }\n    },\n    handleApply(row_index, row){\n      let {name, gpu_num, opt_gpu_num} = row;\n      let applyURL = api_routes.user.apply;\n      this.$confirm('这会提交一次申请，确认吗', 'Warning', {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        this.$message({\n          type: 'success',\n          message: '申请已提交'\n        });\n        apiCall({url: applyURL, data: {name, gpu_num, opt_gpu_num}, method: \"post\"})\n          .then(resp => {this.$message({type: 'info', message: resp.message}); this.tableKey += 1;});\n      }).catch(() => {\n        this.$message({\n          type: 'info',\n          message: '申请取消'\n        });          \n      });\n    },\n    handleDisable(index, row){\n      return row.status != \"free\";\n    }\n  },\n};\n</script>\n"]}]}
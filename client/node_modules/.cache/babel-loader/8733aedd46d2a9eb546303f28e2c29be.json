{"remainingRequest":"/home/zyx/workspaces/python/server_management/client/node_modules/babel-loader/lib/index.js!/home/zyx/workspaces/python/server_management/client/node_modules/eslint-loader/index.js??ref--13-0!/home/zyx/workspaces/python/server_management/client/src/store/modules/auth.js","dependencies":[{"path":"/home/zyx/workspaces/python/server_management/client/src/store/modules/auth.js","mtime":1621256476763},{"path":"/home/zyx/workspaces/python/server_management/client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/zyx/workspaces/python/server_management/client/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/zyx/workspaces/python/server_management/client/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICIvaG9tZS96eXgvd29ya3NwYWNlcy9weXRob24vc2VydmVyX21hbmFnZW1lbnQvY2xpZW50L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9kZWZpbmVQcm9wZXJ0eSI7Cgp2YXIgX2FjdGlvbnMsIF9tdXRhdGlvbnM7CgppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKaW1wb3J0IHsgQVVUSF9SRVFVRVNULCBBVVRIX1NJR05VUCwgQVVUSF9FUlJPUiwgQVVUSF9TVUNDRVNTLCBBVVRIX0xPR09VVCB9IGZyb20gIkAvc3RvcmUvYWN0aW9ucy9hdXRoIjsKaW1wb3J0IHsgVVNFUl9SRVFVRVNUIH0gZnJvbSAiLi4vYWN0aW9ucy91c2VyIjsKaW1wb3J0IHsgYXBpQ2FsbCwgYXBpX3JvdXRlcyB9IGZyb20gIkAvdXRpbHMvYXBpIjsKaW1wb3J0IHJvdXRlciBmcm9tICIuLy4uLy4uL3JvdXRlciI7CnZhciBzdGF0ZSA9IHsKICB0b2tlbjogbG9jYWxTdG9yYWdlLmdldEl0ZW0oInVzZXItdG9rZW4iKSB8fCAiIiwKICBzdGF0dXM6ICIiLAogIGhhc0xvYWRlZE9uY2U6IGZhbHNlCn07CnZhciBnZXR0ZXJzID0gewogIGlzQXV0aGVudGljYXRlZDogZnVuY3Rpb24gaXNBdXRoZW50aWNhdGVkKHN0YXRlKSB7CiAgICByZXR1cm4gISFzdGF0ZS50b2tlbjsKICB9LAogIGF1dGhTdGF0dXM6IGZ1bmN0aW9uIGF1dGhTdGF0dXMoc3RhdGUpIHsKICAgIHJldHVybiBzdGF0ZS5zdGF0dXM7CiAgfQp9Owp2YXIgYWN0aW9ucyA9IChfYWN0aW9ucyA9IHt9LCBfZGVmaW5lUHJvcGVydHkoX2FjdGlvbnMsIEFVVEhfUkVRVUVTVCwgZnVuY3Rpb24gKF9yZWYsIHVzZXIpIHsKICB2YXIgY29tbWl0ID0gX3JlZi5jb21taXQsCiAgICAgIGRpc3BhdGNoID0gX3JlZi5kaXNwYXRjaDsKICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgY29tbWl0KEFVVEhfUkVRVUVTVCk7CiAgICBhcGlDYWxsKHsKICAgICAgdXJsOiBhcGlfcm91dGVzLnVzZXIubG9naW4sCiAgICAgIGRhdGE6IHVzZXIsCiAgICAgIG1ldGhvZDogInBvc3QiCiAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgIGNvbnNvbGUubG9nKHJlc3ApOwoKICAgICAgaWYgKHJlc3AubWVzc2FnZSA9PSAic3VjY2VzcyIpIHsKICAgICAgICBjb25zb2xlLmxvZygic2V0IGl0ZW0gdG9rZW46IiwgcmVzcCwgcmVzcC50b2tlbik7CiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oInVzZXItdG9rZW4iLCByZXNwLnRva2VuKTsgLy8gSGVyZSBzZXQgdGhlIGhlYWRlciBvZiB5b3VyIGFqYXggbGlicmFyeSB0byB0aGUgdG9rZW4gdmFsdWUuCiAgICAgICAgLy8gZXhhbXBsZSB3aXRoIGF4aW9zCiAgICAgICAgLy8gYXhpb3MuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ0F1dGhvcml6YXRpb24nXSA9IHJlc3AudG9rZW4KCiAgICAgICAgY29tbWl0KEFVVEhfU1VDQ0VTUywgcmVzcCk7CiAgICAgICAgZGlzcGF0Y2goVVNFUl9SRVFVRVNUKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjb25zb2xlLmxvZygiYXV0aCBmYWlsZWQiKTsKICAgICAgICBjb21taXQoQVVUSF9FUlJPUiwgImZhaWxlZCIpOwogICAgICB9CgogICAgICByZXNvbHZlKHJlc3ApOwogICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICBjb25zb2xlLmxvZygiZXJyIiwgZXJyKTsKICAgICAgY29tbWl0KEFVVEhfRVJST1IsIGVycik7CiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCJ1c2VyLXRva2VuIik7CiAgICAgIHJlamVjdChlcnIpOwogICAgfSk7CiAgfSk7Cn0pLCBfZGVmaW5lUHJvcGVydHkoX2FjdGlvbnMsIEFVVEhfU0lHTlVQLCBmdW5jdGlvbiAoX3JlZjIsIHVzZXIpIHsKICB2YXIgY29tbWl0ID0gX3JlZjIuY29tbWl0OwogIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICBjb21taXQoQVVUSF9SRVFVRVNUKTsKICAgIGFwaUNhbGwoewogICAgICB1cmw6IGFwaV9yb3V0ZXMudXNlci5zaWdudXAsCiAgICAgIGRhdGE6IHVzZXIsCiAgICAgIG1ldGhvZDogInB1dCIKICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgcmVzb2x2ZShyZXNwKTsKICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsKICAgICAgcmVqZWN0KGVycik7CiAgICB9KTsKICB9KTsKfSksIF9kZWZpbmVQcm9wZXJ0eShfYWN0aW9ucywgQVVUSF9MT0dPVVQsIGZ1bmN0aW9uIChfcmVmMykgewogIHZhciBjb21taXQgPSBfcmVmMy5jb21taXQ7CiAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICBjb21taXQoQVVUSF9MT0dPVVQpOwogICAgbG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oInVzZXItdG9rZW4iKTsKICAgIHJvdXRlci5wdXNoKCIvbG9naW4iKTsKICAgIHJlc29sdmUoKTsKICB9KTsKfSksIF9hY3Rpb25zKTsKdmFyIG11dGF0aW9ucyA9IChfbXV0YXRpb25zID0ge30sIF9kZWZpbmVQcm9wZXJ0eShfbXV0YXRpb25zLCBBVVRIX1JFUVVFU1QsIGZ1bmN0aW9uIChzdGF0ZSkgewogIHN0YXRlLnN0YXR1cyA9ICJsb2FkaW5nIjsKfSksIF9kZWZpbmVQcm9wZXJ0eShfbXV0YXRpb25zLCBBVVRIX1NVQ0NFU1MsIGZ1bmN0aW9uIChzdGF0ZSwgcmVzcCkgewogIHN0YXRlLnN0YXR1cyA9ICJzdWNjZXNzIjsKICBzdGF0ZS50b2tlbiA9IHJlc3AudG9rZW47CiAgc3RhdGUuaGFzTG9hZGVkT25jZSA9IHRydWU7CiAgRXZlbnQuJGVtaXQoInVzZXItYXV0aGVudGljYXRlZCIpOwp9KSwgX2RlZmluZVByb3BlcnR5KF9tdXRhdGlvbnMsIEFVVEhfRVJST1IsIGZ1bmN0aW9uIChzdGF0ZSkgewogIHN0YXRlLnN0YXR1cyA9ICJlcnJvciI7CiAgc3RhdGUuaGFzTG9hZGVkT25jZSA9IHRydWU7Cn0pLCBfZGVmaW5lUHJvcGVydHkoX211dGF0aW9ucywgQVVUSF9MT0dPVVQsIGZ1bmN0aW9uIChzdGF0ZSkgewogIHN0YXRlLnRva2VuID0gIiI7Cn0pLCBfbXV0YXRpb25zKTsKZXhwb3J0IGRlZmF1bHQgewogIHN0YXRlOiBzdGF0ZSwKICBnZXR0ZXJzOiBnZXR0ZXJzLAogIGFjdGlvbnM6IGFjdGlvbnMsCiAgbXV0YXRpb25zOiBtdXRhdGlvbnMKfTs="},{"version":3,"sources":["/home/zyx/workspaces/python/server_management/client/src/store/modules/auth.js"],"names":["AUTH_REQUEST","AUTH_SIGNUP","AUTH_ERROR","AUTH_SUCCESS","AUTH_LOGOUT","USER_REQUEST","apiCall","api_routes","router","state","token","localStorage","getItem","status","hasLoadedOnce","getters","isAuthenticated","authStatus","actions","user","commit","dispatch","Promise","resolve","reject","url","login","data","method","then","resp","console","log","message","setItem","catch","err","removeItem","signup","push","mutations","Event","$emit"],"mappings":"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","sourcesContent":["import {\n  AUTH_REQUEST,\n  AUTH_SIGNUP,\n  AUTH_ERROR,\n  AUTH_SUCCESS,\n  AUTH_LOGOUT\n} from \"@/store/actions/auth\";\nimport { USER_REQUEST } from \"../actions/user\";\nimport { apiCall, api_routes } from \"@/utils/api\";\nimport router from \"./../../router\";\n\nconst state = {\n  token: localStorage.getItem(\"user-token\") || \"\",\n  status: \"\",\n  hasLoadedOnce: false\n};\n\nconst getters = {\n  isAuthenticated: state => !!state.token,\n  authStatus: state => state.status\n};\n\nconst actions = {\n  [AUTH_REQUEST]: ({ commit, dispatch }, user) => {\n    return new Promise((resolve, reject) => {\n      commit(AUTH_REQUEST);\n      apiCall({ url: api_routes.user.login, data: user, method: \"post\" })\n        .then(resp => {\n          console.log(resp);\n          if(resp.message == \"success\") {\n            console.log(\"set item token:\", resp, resp.token);\n            localStorage.setItem(\"user-token\", resp.token);\n            // Here set the header of your ajax library to the token value.\n            // example with axios\n            // axios.defaults.headers.common['Authorization'] = resp.token\n            commit(AUTH_SUCCESS, resp);\n            dispatch(USER_REQUEST);\n          }else{\n            console.log(\"auth failed\");\n            commit(AUTH_ERROR, \"failed\");\n          }\n          resolve(resp);\n        })\n        .catch(err => {\n          console.log(\"err\", err);\n          commit(AUTH_ERROR, err);\n          localStorage.removeItem(\"user-token\");\n          reject(err);\n        });\n    });\n  },\n  [AUTH_SIGNUP]: ({ commit }, user) => {\n    return new Promise((resolve, reject) => {\n      commit(AUTH_REQUEST);\n      apiCall({ url: api_routes.user.signup, data: user, method: \"put\" })\n        .then(resp => {\n          resolve(resp);\n        })\n        .catch(err => {\n          reject(err);\n        });\n    });\n  },\n  [AUTH_LOGOUT]: ({ commit }) => {\n    return new Promise(resolve => {\n      commit(AUTH_LOGOUT);\n      localStorage.removeItem(\"user-token\");\n      router.push(\"/login\");\n      resolve();\n    });\n  }\n};\n\nconst mutations = {\n  [AUTH_REQUEST]: state => {\n    state.status = \"loading\";\n  },\n  [AUTH_SUCCESS]: (state, resp) => {\n    state.status = \"success\";\n    state.token = resp.token;\n    state.hasLoadedOnce = true;\n    Event.$emit(\"user-authenticated\");\n  },\n  [AUTH_ERROR]: state => {\n    state.status = \"error\";\n    state.hasLoadedOnce = true;\n  },\n  [AUTH_LOGOUT]: state => {\n    state.token = \"\";\n  }\n};\n\nexport default {\n  state,\n  getters,\n  actions,\n  mutations\n};\n"]}]}